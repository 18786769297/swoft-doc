<!-- cache time: 20190521.020158 -->
<h1>定义命令</h1>
<p>一个命令由命令组和执行命令组成，一个类就是一个命令组，类里面的方法对应操作命令，一个命令的运行，是通过执行命令组对应的操作命令。</p>
<h2>注解</h2>
<p>命令的定义主要通过 <code>@Command</code> 和 <code>@CommandMapping</code>两个注解，<code>@Command</code> 定义命令组名称，<code>@CommandMapping</code> 定义操作命令的映射关系。</p>
<h3>Command 注解</h3>
<p><strong>@Command</strong></p>
<p>定义命令组，标记一个类为console命令类</p>
<p>拥有属性：</p>
<ul>
<li><code>name</code> 参数，定义命令组名称，如果缺省，根据类名称自动解析</li>
<li><code>alias</code> 命令组别名，通过别名仍然可以访问它。<em>允许多个，以逗号隔开即可</em></li>
<li><code>desc</code> 命令组描述信息说明，支持颜色标签</li>
<li><code>coroutine</code> 定义是否为协程下运行，默认 true, 框架会启动一个协程运行该命令</li>
</ul>
<blockquote>
<p>若 <code>desc</code> 为空，将会自动解析类的第一行注释作为描述</p>
</blockquote>
<h3>CommandMapping 注解</h3>
<p><strong>@CommandMapping</strong></p>
<p>定义操作命令映射关系，标明了一个具体的命令</p>
<p>拥有属性：</p>
<ul>
<li><code>name</code> 参数，定义命令组名称，如果缺省，会执行使用方法名称</li>
<li><code>alias</code> 命令别名，通过别名仍然可以访问它。<em>允许多个，以逗号隔开即可</em></li>
<li><code>desc</code> 命令的描述信息说明，支持颜色标签</li>
</ul>
<blockquote>
<p>若 <code>desc</code> 为空，将会自动解析类的第一行注释作为描述</p>
</blockquote>
<p>命令帮助信息是命令使用说明信息，也是通过注解完成定义。</p>
<ul>
<li>类描述，对应命令组信息描述</li>
<li>方法描述，对应该执行命令的信息描述</li>
<li><code>@Usage</code> 定义使用命令格式</li>
<li><code>@Options</code> 定义命令选项参数</li>
<li><code>@Arguments</code> 定义命令参数</li>
<li><code>@Example</code> 命令使用例子</li>
</ul>
<h2>代码示例</h2>
<pre><code class="language-php">/**
 * Provide some commands for manage and watch swoft server project
 *
 * @Command()
 */
class TestCommand
{
    /**
     * Start the swoft server and monitor the file changes to restart the server
     *
     * @CommandMapping()
     * @CommandArgument("targetPath", type="path",
     *     desc="Your swoft project path, default is current work directory"
     * )
     * @CommandOption("interval", type="integer", default=3,
     *     desc="Interval time for watch files, unit is seconds"
     * )
     * @CommandOption(
     *     "bin-file", short="b", type="string", default="bin/swoft",
     *     desc="Entry file for the swoft project"
     * )
     * @CommandOption(
     *     "start-cmd", short="c", type="string", default="http:start",
     *     desc="the server startup command to be executed"
     * )
     * @CommandOption(
     *     "watch", short="w", default="app,config", type="directories",
     *     desc="List of directories you want to watch, relative the &lt;cyan&gt;targetPath&lt;/cyan&gt;"
     * )
     * @example
     *   {binFile} run -c ws:start -b bin/swoft /path/to/php/swoft
     * @param Input $input
     */
    public function run(Input $input): void
    {
        Show::aList([
            'options'   =&gt; $input-&gt;getOpts(),
            'arguments' =&gt; $input-&gt;getArgs(),
        ]);
    }
}</code></pre>
<blockquote>
<p>命令逻辑里面可以使用 Swoft 所有功能</p>
</blockquote>
<h2>运行</h2>
<ul>
<li>现在你可以执行 <code>php bin/swoft</code>, 命令列表中将会显示 test 命令</li>
<li>执行 <code>php bin/swoft test</code> 或者 <code>php bin/swoft test -h</code> 将会看到 test组里拥有的具体命令</li>
<li>执行 <code>php bin/swoft test:run -h</code> 将会看到此命令的完整帮助信息</li>
</ul>